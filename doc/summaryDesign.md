# 概要设计

### 目录

一、功能设计

二、数据库数据设计

三、界面设计

四、框架设计



### 一、功能设计

#### 1. 用例图

##### 整体用例图

![用例图](\asset\用例图.png)

##### 个体的用例图

+ 企业用户

![企业用例图](\asset\企业用户用例图.png)

+ 省用户

![省用户用例图](\asset\省用户用例图.png)

+ 市用户

![市用户用例图](\asset\市用户用例图.png)



##### 省市企业需求对比

<img src="\asset\省市对比省部分.png" style="zoom: 50%;" />

<img src="\asset\省市对比市部分.png" style="zoom: 50%;" />

#### 2. 各用例设计

##### 登录

+ 基本描述：

    用户输入账号密码，后台自动按照用户的类型和权限进入不同端的页面主页

+ 基本事件流：

    1. 用户输入账户密码后点击登录。
    2. 后台在数据库中检查登录的账号密码是否匹配，返回登录结果和用户类型信息。
    3. 用户能看到登陆结果。如果登陆成功，进入相应的客户端主页；否则需要重新输入账号密码，或者联系省端进行密码找回。

+ 特殊情况：

    + 如果企业用户**以“未备案成功”状态**登录网页，需要首先进入“企业备案” 页面进行信息备案；等待备案通过后，才可使用其他功能。

##### 企业端：

+ 企业备案：

    + 基本描述：

        企业端用户在使用其他功能之前，需要先进行备案。备案信息包括：所属地区、组织机构代码、企业名称、企业性质、所属行业、主要经营业务、联系人、联系地址、邮政编码、联系电话、传真、EMAIL等。包括填表、修改和查看功能。

    + 基本事件流：

        1. 当企业用户第一次进入系统时，**企业用户的状态为“未备案成功”**，此时只能进入企业备案页面；
        2. 填写相关备案信息并确认后，数据上传到数据库，此时**企业用户的状态仍然为“未备案成功”**，等待省政府的备案审批；
        3. 等待省政府备案审批通过后，此时**企业用户的状态变为“备案成功”**，下次企业用户登录系统时将可以使用所有企业用户可以使用的功能。

    + 特殊情况：

        + 当**处于“备案成功”状态下的企业用户**之后需要查看或者修改自己的备案信息时，此时可以查看备案所有的信息，但只能修改联系人、联系地址、邮政编码、联系电话、传真、EMAIL等非重要信息。并且此次修改直接传到数据库中，不再需要审批和企业用户状态的切换。

+ 数据上报：

    + 基本描述：

        企业端用户在每一调查期内，都应该上报一次调查期内企业的就业人数信息。如果有就业人数减少的现象，还需选择就业人数减少类型和造成就业人数减少的原因，并说明大致情况。

    + 基本事件流：

        1. 企业用户进入“数据上报”页面，如果在本调查期内企业已填写上报数据，或者填写上报数据后被驳回，都会直接显示填报的数据情况；如果在一个调查期内，企业第一次进入该页面，那么只有**“建档期人数”**处有信息，默认是上一调查期企业上报的“调查期人数”（如果企业第一次使用“数据上报功能”，见下方的特殊情况）。
        2. **当且仅当企业处于“未上报数据”或者“企业上报市未审核”状态，**才可以点击“数据上报”页面的修改。当企业点击下方的“修改”后，进入“调整报表”页面，在该页面中可以修改报表中相关的数据，修改完成后，点击“提交“按钮后，即可上报本调查期内的报表。
        3. 当企业处于**“企业上报市未审核”状态，**时，企业可以反复使用”数据上报“页面的修改功能，修改企业上报的报表数据。等到企业处于”市审批通过“状态后（除非因为被省审批驳回会回到**“未上报数据”状态**），企业就不能再手动修改报表数据了。

    ![](\asset\数据上报流程的企业状态转移图.png)

    + 特殊情况：
        + 当企业用户第一次使用“数据上报”功能时，此时建档期默认无数字。当企业输入调查期人数时，建档期就业人数自动与输入的调查期人数一致。由于此次建档期人数等于调查期人数，就业人数减少类型和造成就业人数减少的原因便无需填写。

+ 通知查询

    + 基本事件流：

        ![image-20231026165337052](/asset/查看通知事件流图.png)

+ 本企业数据查询

    + 基本描述：

        企业端用户可以查询往期上报的相关数据。

    + 基本事件流：

        1. 企业用户进入”数据查询“页面，选择相应的时间段后，点击”查询”按钮。
        2. 后台服务器先根据用户在前一步骤中选择时间段所覆盖的调查期，然后在数据库中调出该用户在所覆盖的调查期内上报数据
        3. 前台以表格的形式显示出该数据



##### 省端：

+ 审核备案
    + 基本描述
    
    **省用户** 能够查看本省所有已通过、待审核、已驳回、未上报的企业备案信息，并对待审核的备案信息进行审核，但不可修改。支持按时间、按地区、按关键字查询企业备案信息。支持对需要的企业备案信息导出为Excel文件。
    
    + 基本事件流
    
        1. 在省客户端部分，点击“备案审核”进入企业备案审核界面。在企业备案审核页面中，顶部是查找栏，可以按时间、按地区、按关键字查询对应的企业审核状态，查找栏右侧是导出按键，可以将相应的备案信息导出为Excel文件。查找栏下面是企业备案的状态栏，分为已通过、待审核、已驳回、未上报四个状态，点击不同的状态，会在页面下方显示出不同的备案状态表格，并且在表格最顶端显示数据总条数。点击表格最后一列的查看按钮，可以查看该企业的具体备案信息。
        2. 在具体备案信息页面，展示企业的信息，包括所属地区、组织机构代码、企业名称、企业性质、所属行业、主要经营业务、联系人、联系地址、邮政编码、联系电话、传真、EMAIL等。对于不同的状态，页面底部有相应的按钮。若企业备案信息为已通过状态，则页面底部显示已通过按键，且不可点击；若企业备案信息为待审核状态，则页面底部显示通过、驳回按键，点击通过则表示审核通过，点击驳回则弹出输入框，输入驳回理由，表示未通过；若企业备案信息为已驳回状态，则页面底部显示已驳回按键，且不可点击；对于未上报状态，企业详细信息页面只显示企业名称、账号等基本信息。
    
+ 查询企业信息
    + 基本描述
    + 基本事件流
    
+ 审核和上报数据
    + 基本描述
    
      省端用户需要在每一调查期内，对市端审核通过后上报的数据再次进行审核，如果审核之后没有错误就可以通过，如果审核之后发现存在错误，则需要直接退回到企业端，并写下退回修改建议，待企业修改之后再重新上报到市，再次进行审核流程。
    
    + 基本事件流
    
      1. 省端用户进入**”数据审核”界面**，可以查看全省企业的数据上报情况，首先以**按市划分的列表**展示全省各市的上报情况，包括已上报数量和未上报数量，对全省各市的上报情况进行一个概览。
      2. 省端用户可以进一步**点击某个市的已上报数量**进行具体各企业上报情况的查看，进入**“已上报”界面**，可以看到各个企业概览信息列表，包括**企业编号、企业名称、审核状态、上报状态、操作**，再进一步点击操作中的**查看**，可以进入**“详细信息”**界面，用户可以看到企业上报时的所有数据。
      3. 省端用户看到“详细信息”界面后，可以查看企业上报的数据，进行检查，若确认无误，则可以点击界面下方的**“审核通过”**，点击之后界面下方按钮消失，显示为**状态：审核通过**。
      4. 省端用户在进行检查时若发现有问题，则可以点击界面下方的**”退回修改”**，此时会跳出一个输入框，可以输入**退回修改建议**，最后点击**”提交“**按钮，回到”已上报“界面。
      5. 省端用户在”数据审核“界面可以进一步查看每个市未上报企业的详细信息，点击某市的**”未上报“**栏，进入**“未上报界面”**，可以查看市里**未上报企业和退回修改企业**的名称、编号、状态和联系电话，对于退回修改企业，可以进一步点击退回修改企业下拉查看退回的上报信息。
    
+ 发布通知
    + 基本描述
    + 基本事件流
    
+ 数据查询
    + 基本描述
    
      省端用户可以按选择条件，筛选查看符合条件的企业上报数据。
    
    + 基本事件流
    
      1. 省端用户进入**”数据查询“**界面，在界面上可以对**企业名称、企业编号、单位性质、所属行业、所在地区、调查期**进行条件选择，然后进行查询。
      2. 在点击**”查询“**按钮后，跳转到**“查询结果“**界面，查询界面显示出符合条件的各个企业的企业信息概览。
      3. 选择要查看企业的一栏，点击**”查看“**,进入**详细信息**界面，可以查看具体上报的数据。
    
+ 代填报数据
    + 基本描述
    
      点击省市端的数据填报按钮跳转到相应界面，用户进入页面后右侧边栏自动显示当前调查期仍未上报数据的企业列表，且在列表中提供选择按钮，点击对应企业的选择按钮将显示该企业的填报记录，填报记录的数据格式和数据查询所获取的格式相同，可以通过调查期来筛选数据，之后手动填写就业数据，且必须与上一调查期保持一致，上报后日志自动记录此次填写
    
    + 基本事件流
    
      1.用户进入代填报界面后首先进入一个企业名单界面，该名单中的企业都为当前调查期仍未填报数据的企业名单
    
      2.用户选择一个企业，界面会显示该企业的往期数据，包括就业数据和调查期信息，用户可以根据调查期区间查询企业对应的数据，当用户再次选择其他企业，该界面会转换未为对应的企业数据
    
      3.用户填写选择的企业的调查期就业人数，点击提交，后台自动生成日志记录
+ 数据汇总
    + 基本描述
    
      ​	数据汇总可以根据不同调查期，企业月度，企业季度，地区，企业性质和行业对企业提交的就业数据进行汇总，并生成对应的汇总表，汇总方式包括求和，最大值和最小值和平均值，最终的汇总表可以导出
    
    + 基本事件流
    
      1.省市用户进入数据汇总界面首先可以看到**三个选择项和两个表格**，第一个表格为**当前调查下**的企业就业人数情况，表单表头为企业名称，企业性质，所属行业，地区，调查期，就业人数；第二个表格为空表格，表头为**汇总项和就业人数**
    
      2.选择三个选项框的的对应选项，点击汇总，网页会向服务器发送数据请求，请求条件为**汇总项**，网页拿到数据后会对数据进行分类汇总，生成一个新的**数据对象数组**，对象包括汇总项和就业人数，该对象数组会显示在第二个表格上，此时表头汇总项为选择的汇总项
    
      3.点击导出按钮会自动将第二个表格导出为excel，并下载到本地
+ 数据分析
    + 基本描述
    
      数据分析总共包括取样分析和图表分析，其中图表分析包括趋势分析和对比分析，其中取样分析为省独有的功能，图表分析为省和市共有的功能，图表分析的样本条件为地区、企业性质、行业，分析指标中的岗
    
    + 基本事件流
    
      其中趋势分析和对比分析的事件流基本一致可归为图表分析
    
      图表分析事件流：
      
      1.用户进入界面后整个界面只有日期选择，企业性质选择，所属行业选择和地区选择栏，选择后可进入下一状态
      
      2.进入下一状态后会在界面上显示折线图和图表，点击图表下面的导出按钮图表可导出表格
      
      取样分析事件流：
      
      1.用户进入取样分析界面后，直接展示企业数量表格和饼状图，企业数量表格每一个表项提供勾选项，默认全部勾选，当取消某个表现的勾选时，饼状图也会发生对应的变化，全部取消后饼状图不显示
      
      2.用户查询对应的市区后可以对该市区进行选择和取消，同时饼状图也会发生变化
    
+ 系统设置
    + 基本描述：
    
        省级用户拥有权限系统的用户、角色、调查期进行设置、修改；并且可以查看系统的运行情况。
    
    + 基本事件流
    
      1. 省级用户进入“系统设置”界面；将会有四个选项：用户管理、角色管理、调查期管理和系统监测
      2. 用户进入用户管理可以新建用户，并且对已有的用户进行修改基本信息
      3. 用户进入角色管理可以增添、删除角色；每一个用户对应于一种角色，每一个角色都有多个用户；如果删除一个角色，不应当删除对应的用户，而要为该用户分配新的角色后才可删除该角色。
      4. 用户进入调查期管理可以新建或修改调查期；新建调查期意味着企业端有新的数据待填报；而修改调查期意味着本轮的调查期的调查时间或者填报时间被修改，如果调查时间修改每个企业应当重新填报，而填报时间修改则是企业需要关注是否填报完成
      5. 用户进入系统监测可以可视化的查看系统的当前运行情况。





##### 市端：

省端的子集。具体用例设计可以查看省端。



### 二、数据库数据设计





### 三、界面设计

请见vue界面



### 四、框架设计

采用 vue + springboot + mysql的框架

| 使用技术   | 相关版本                                                     |
| ---------- | ------------------------------------------------------------ |
| vue        | 使用vue2<br />npm：9.8.1<br />vue/cli：5.0.8<br />element-ui：2.15.14<br />其余部件版本可见 仓库`\src\ui\vue-test\`目录下`package-lock.json`文件 |
| springboot | springboot：3.13<br />jdk：17                                |
| mysql      | 待定                                                         |

